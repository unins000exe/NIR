\documentclass[bachelor, och, nir]{SCWorks}
% параметр - тип обучения - одно из значений:
%    spec     - специальность
%    bachelor - бакалавриат (по умолчанию)
%    master   - магистратура
% параметр - форма обучения - одно из значений:
%    och   - очное (по умолчанию)
%    zaoch - заочное
% параметр - тип работы - одно из значений:
%    referat    - реферат
%    coursework - курсовая работа (по умолчанию)
%    diploma    - дипломная работа
%    pract      - отчет по практике
% параметр - включение шрифта
%    times    - включение шрифта Times New Roman (если установлен)
%               по умолчанию выключен
\usepackage{subfigure}
\usepackage{tikz,pgfplots}
\pgfplotsset{compat=1.5}
\usepackage{float}

%\usepackage{titlesec}
\setcounter{secnumdepth}{4}
%\titleformat{\paragraph}
%{\normalfont\normalsize}{\theparagraph}{1em}{}
%\titlespacing*{\paragraph}
%{35.5pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

\titleformat{\paragraph}[block]
{\hspace{1.25cm}\normalfont}
{\theparagraph}{1ex}{}
\titlespacing{\paragraph}
{0cm}{2ex plus 1ex minus .2ex}{.4ex plus.2ex}

% --------------------------------------------------------------------------%
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\graphicspath{ {./img/} }
\usepackage{tempora}

\usepackage[sort,compress]{cite}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{fancyvrb}
\usepackage{listings}
\usepackage{listingsutf8}
\usepackage{longtable}
\usepackage{array}
\usepackage[english,russian]{babel}

\usepackage{url}
\usepackage[colorlinks=true, linkcolor=black]{hyperref}

\usepackage{underscore}
\usepackage{setspace}
\usepackage{indentfirst} 
\usepackage{mathtools}
\usepackage{amsfonts}
\usepackage{enumitem}
\usepackage{tikz}
\usepackage{textgreek}
\usepackage{slashbox}

\usepackage{minted}
\setminted[python3]{style=bw, linenos, breaklines=true, fontsize=\footnotesize}
\setminted[py]{fontsize=\small, breaklines=true, style=bw, linenos}

\newcommand{\eqdef}{\stackrel {\rm def}{=}}
\newcommand{\specialcell}[2][c]{%
\begin{tabular}[#1]{@{}c@{}}#2\end{tabular}}

\renewcommand\theFancyVerbLine{\small\arabic{FancyVerbLine}}

\newtheorem{lem}{Лемма}

\begin{document}

% Кафедра (в родительном падеже)
\chair{теоретических основ компьютерной безопасности и криптографии}

% Тема работы
\title{Число независимого доминирования и число совершенного геодоминирования}

% Курс
\course{5}

% Группа
\group{531}

% Факультет (в родительном падеже) (по умолчанию "факультета КНиИТ")
\department{факультета КНиИТ}

% Специальность/направление код - наименование
%\napravlenie{09.03.04 "--- Программная инженерия}
%\napravlenie{010500 "--- Математическое обеспечение и администрирование информационных систем}
%\napravlenie{230100 "--- Информатика и вычислительная техника}
%\napravlenie{231000 "--- Программная инженерия}
\napravlenie{10.05.01 "--- Компьютерная безопасность}

% Для студентки. Для работы студента следующая команда не нужна.
% \studenttitle{Студентки}

% Фамилия, имя, отчество в родительном падеже
\author{Стаина Романа Игоревича}

% % Заведующий кафедрой
% \chtitle{д. ф.-м. н., доцент} % степень, звание
% \chname{М.~Б.~Абросимов}

%Научный руководитель (для реферата преподаватель проверяющий работу)
\satitle{д. ф.-м. н., доцент} %должность, степень, звание
\saname{М.~Б.~Абросимов}

% Руководитель практики от организации (только для практики,
% для остальных типов работ не используется)
% \patitle{к.ф.-м.н.}
% \paname{С.~В.~Миронов}

% Семестр (только для практики, для остальных
% типов работ не используется)
%\term{8}

% Наименование практики (только для практики, для остальных
% типов работ не используется)
%\practtype{преддипломная}

% Продолжительность практики (количество недель) (только для практики,
% для остальных типов работ не используется)
%\duration{4}

% Даты начала и окончания практики (только для практики, для остальных
% типов работ не используется)
%\practStart{30.04.2019}
%\practFinish{27.05.2019}

% Год выполнения отчета
\date{2024}

\maketitle

% Включение нумерации рисунков, формул и таблиц по разделам
% (по умолчанию - нумерация сквозная)
% (допускается оба вида нумерации)
% \secNumbering

%-------------------------------------------------------------------------------------------

% \begin{minted}[fontsize=\small]{MySQL}
% \end{minted}

% \begin{figure}[H]
%     \centering
%     \includegraphics[width=0.999\textwidth]{img/}
%     \caption{}
%     \label{easy_hack}
% \end{figure}

\tableofcontents

\intro
Введение

\section{Алгоритмы} 
Алгоритмы

\section{Результаты исследования}
\begin{table}[H]
    \begin{tabular}{|c|c|c|}
    \hline
    \backslashbox[1pt]{$g_p$}{$\gamma_i$} & 1 & 2 \\ \hline
    1                                     & 0 & 0 \\ \hline
    2                                     & 1 & 0 \\ \hline
    \end{tabular}
    \caption{Количество 2-вершинных графов, имеющих заданные $g_p$ и $\gamma_i$}
\end{table}

\begin{table}[H]
    \begin{tabular}{|c|c|c|c|}
    \hline
    \backslashbox[1pt]{$g_p$}{$\gamma_i$} & 1 & 2 & 3 \\ \hline
    1                                     & 0 & 0 & 0 \\ \hline
    2                                     & 1 & 0 & 0 \\ \hline
    3                                     & 1 & 0 & 0 \\ \hline
    \end{tabular}
    \caption{Количество 3-вершинных графов, имеющих заданные $g_p$ и $\gamma_i$}
\end{table}

\begin{table}[H]
    \begin{tabular}{|c|c|c|c|c|}
    \hline
    \backslashbox[1pt]{$g_p$}{$\gamma_i$} & 1 & 2 & 3 & 4 \\ \hline
    1                                     & 0 & 0 & 0 & 0 \\ \hline
    2                                     & 1 & 2 & 0 & 0 \\ \hline
    3                                     & 0 & 0 & 0 & 0 \\ \hline
    4                                     & 3 & 0 & 0 & 0 \\ \hline
    \end{tabular}
    \caption{Количество 4-вершинных графов, имеющих заданные $g_p$ и $\gamma_i$}
\end{table}

\begin{table}[H]
    \begin{tabular}{|c|c|c|c|c|c|}
    \hline
    \backslashbox[1pt]{$g_p$}{$\gamma_i$} & 1 & 2 & 3 & 4 & 5 \\ \hline
    1                                     & 0 & 0 & 0 & 0 & 0 \\ \hline
    2                                     & 2 & 3 & 0 & 0 & 0 \\ \hline
    3                                     & 0 & 2 & 0 & 0 & 0 \\ \hline
    4                                     & 2 & 1 & 0 & 0 & 0 \\ \hline
    5                                     & 7 & 4 & 0 & 0 & 0 \\ \hline
    \end{tabular}
    \caption{Количество 5-вершинных графов, имеющих заданные $g_p$ и $\gamma_i$}
\end{table}

\begin{table}[H]
    \begin{tabular}{|c|c|c|c|c|c|c|}
    \hline
    \backslashbox[1pt]{$g_p$}{$\gamma_i$} & 1 & 2 & 3 & 4 & 5 & 6 \\ \hline
    1                                     & 0 & 0 & 0 & 0 & 0 & 0 \\ \hline
    2                                     & 4 & 11 & 0 & 0 & 0 & 0 \\ \hline
    3                                     & 0 & 8 & 0 & 0 & 0 & 0 \\ \hline
    4                                     & 8 & 14 & 0 & 0 & 0 & 0 \\ \hline
    5                                     & 7 & 11 & 0 & 0 & 0 & 0 \\ \hline
    6                                     & 15 & 28 & 4 & 0 & 0 & 0 \\ \hline
    \end{tabular}
    \caption{Количество 6-вершинных графов, имеющих заданные $g_p$ и $\gamma_i$}
\end{table}

\begin{table}[H]
    \begin{tabular}{|c|c|c|c|c|c|c|c|}
    \hline \backslashbox[1pt]{$g_p$}{$\gamma_i$} 
      & 1 & 2 & 3 & 4 & 5   & 6 & 7 \\ \hline
    1 & 0 & 0 & 0 & 0 & 0   & 0 & 0 \\ \hline
    2 & 11 & 23 & 1 & 0 & 0  & 0 & 0 \\ \hline
    3 & 0 & 70 & 2 & 0 & 0   & 0 & 0 \\ \hline
    4 & 24 & 122 & 8 & 0 & 0  & 0 & 0 \\ \hline
    5 & 53 & 108 & 17 & 0 & 0  & 0 & 0 \\ \hline
    6 & 26 & 100 & 14 & 0 & 0 & 0 & 0 \\ \hline
    7 & 42 & 192 & 40 & 0 & 0 & 0 & 0 \\ \hline
    \end{tabular}
    \caption{Количество 7-вершинных графов, имеющих заданные $g_p$ и $\gamma_i$}
\end{table}

\begin{table}[H]
    \begin{tabular}{|c|c|c|c|c|c|c|c|c|}
    \hline \backslashbox[1pt]{$g_p$}{$\gamma_i$} 
      & 1  & 2   & 3  & 4 & 5 & 6 & 7     & 8 \\ \hline
    1 & 0  & 0   & 0  & 0 & 0 & 0 & 0     & 0 \\ \hline
    2 & 34 & 137  & 5  & 0 & 0 & 0 & 0    & 0 \\ \hline
    3 & 0  & 581  & 4  & 0 & 0 & 0 & 0    & 0 \\ \hline
    4 & 126 & 1638 & 107 & 2 & 0 & 0 & 0  & 0 \\ \hline
    5 & 314 & 1489 & 238 & 1 & 0 & 0 & 0  & 0 \\ \hline
    6 & 283 & 1467 & 314 & 4 & 0 & 0 & 0  & 0 \\ \hline
    7 & 145 & 1249 & 350 & 0 & 0 & 0 & 0  & 0 \\ \hline
    8 & 142 & 1865 & 601 & 21 & 0 & 0 & 0 & 0 \\ \hline
    \end{tabular}
    \caption{Количество 8-вершинных графов, имеющих заданные $g_p$ и $\gamma_i$}
\end{table}

\begin{table}[H]
    \begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}
    \hline \backslashbox[1pt]{$g_p$}{$\gamma_i$} 
      & 1  & 2   & 3  & 4 & 5 & 6 & 7     & 8 & 9\\ \hline
    1 & 0  & 0   & 0  & 0 & 0 & 0 & 0     & 0 & 0\\ \hline
    2 & 156 & 888  & 1  & 0 & 0 & 0 & 0    & 0 & 0\\ \hline
    3 & 0  & 8002  & 182  & 0 & 0 & 0 & 0    & 0 & 0\\ \hline
    4 & 861 & 31921 & 1853 & 13 & 0 & 0 & 0  & 0 & 0\\ \hline
    5 & 3422 & 38055 & 6310 & 27 & 0 & 0 & 0  & 0 & 0\\ \hline
    6 & 3477 & 33948 & 7715 & 66 & 0 & 0 & 0  & 0 & 0\\ \hline
    7 & 2461 & 29432 & 9134 & 144 & 0 & 0 & 0  & 0 & 0\\ \hline
    8 & 1210 & 25377 & 10380 & 184 & 0 & 0 & 0 & 0 & 0\\ \hline
    9 & 759 & 31055 & 13511 & 535 & 1 & 0 & 0 & 0 & 0\\ \hline
    \end{tabular}
    \caption{Количество 9-вершинных графов, имеющих заданные $g_p$ и $\gamma_i$}
\end{table}

\conclusion
Заключение

% \bibliographystyle{gost780uv}
% \inputencoding{cp1251}
% \bibliography{thesis}
% \inputencoding{utf8}

\appendix

    \section{Листинг \texttt{main.py}}
    % \inputminted{python3}{multi_main.py}
    \begin{minted}[]{python3}
        # число независимого доминирования и число совершенного геодоминирования
        from sys import stdin
        import networkx as nx
        import matplotlib.pyplot as plt
        import time
        from itertools import combinations
        import multiprocessing as mp
        
        
        def find_maximal_independent_sets(g):
            # 1 Начальная установка
            k, s, q_minus, q_plus = 0, [], [[]], [list(g.nodes)]
            result = []
        
            def step2(k):
                xk = q_plus[k][0]
                s.append(xk)
                if k >= len(q_minus) - 1:
                    q_minus.append([])
                else:
                    q_minus[k + 1] = list(set(q_minus[k]) - set(g.adj[xk]))
                t_plus_k = q_plus[k].copy()
                t_plus_k.remove(xk)
                if k >= len(q_plus) - 1:
                    q_plus.append(list(set(t_plus_k) - set(g.adj[xk])))
                else:
                    q_plus[k + 1] = list(set(t_plus_k) - set(g.adj[xk]))
                k += 1
                # print(f'Шаг 2 \nk = {k}, xk = {xk} \nS = {s} \nQ+ = {q_plus} \nQ- = {q_minus}')
                return xk, k
        
            def step5(s, k):
                k -= 1
                xk = s[k]
                s.pop()
                q_plus[k].remove(xk)
                q_minus[k].append(xk)
                # print(f'Шаг 5 \nk = {k}, xk = {xk} \nS = {s} \nQ+ = {q_plus} \nQ- = {q_minus}')
                return k
        
            while len(q_plus[0]) != 0:
                if k != 0:
                    # 3 Проверка
                    if xk in q_minus and set(g.adj[xk]) & set(q_plus[k]) == set():
                        k = step5(s, k)
                    else:
                        # 4
                        if len(q_plus[k]) == 0:
                            if len(q_minus[k]) == 0:
                                # print('=' * 40)
                                # print(f'{s} к результату')
                                result.append(s.copy())
                                # print('=' * 40)
                                k = step5(s, k)
                            else:
                                k = step5(s, k)
                        else:
                            xk, k = step2(k)
                else:
                    xk, k = step2(k)
            return result
        
        
        def independent_domination_number(g):
            g = nx.from_graph6_bytes(g[0:-1].encode())
            maximal_independent_sets = find_maximal_independent_sets(g)
            maximal_independent_sets.sort(key=len)
            for s in maximal_independent_sets:
                if nx.is_dominating_set(g, s):
                    return len(s)
        
        
        def find_perfect_geodominating_sets(g):
            g = nx.from_graph6_bytes(g[0:-1].encode())
            nodes = set(g.nodes)
            nodes_len = len(nodes)
            all_paths = [[None] * nodes_len for _ in range(nodes_len)]
        
            for k in range(2, len(nodes)):
                # Всевозможные варианты множества вершин S
                for si in combinations(nodes, k):
                    s = set(si)
                    v = nodes - s
                    # print('S =', si)
                    # print('V\\S =', v)
        
                    paths = []
                    # Всевозможные кратчайшие пути между вершинами из S
                    for a, b in combinations(s, 2):
                        if all_paths[a][b] is None:
                            all_paths[a][b] = list(nx.all_shortest_paths(g, a, b))
                        for p in all_paths[a][b]:
                            paths += p[1:-1]
        
                    # print('Пути', paths)
                    if len(paths) == 0:
                        continue
        
                    flag = True
                    for node in v:
                        count = paths.count(node)
                        # Если какая-то вершина из V\S встречается больше одного раза, значит
                        # она геодоминируется несколькими парами вершин из S. Или вершина не геод-ся вовсе
                        if count != 1:
                            # print('No', si)
                            flag = False
                            break
        
                    if flag:
                        # print('S', si)
                        # print('V\\S', v)
                        return len(si)
            # Если не получилось найти, значит в S должны быть все вершины
            # print('S', nodes)
            return nodes_len
        
        
        if __name__ == '__main__':
            graphs6 = stdin.readlines()
            t0 = time.time()
            g = nx.from_graph6_bytes(graphs6[0][0:-1].encode())
            num_nodes = len(g.nodes)
        
            agents = 4
            chunksize = 4
            with mp.Pool(processes=agents) as pool:
                result = pool.map(find_perfect_geodominating_sets, graphs6, chunksize)
                result2 = pool.map(independent_domination_number, graphs6, chunksize)
        
            table = [[0] * num_nodes for _ in range(num_nodes)]
            for a, b in zip(result, result2):
                table[a - 1][b - 1] += 1
        
            for row in table:
                print(row)
        
        
            print(f'Время работы: {time.time() - t0} сек.')
        
    \end{minted}

\end{document}